<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebSocket</title>
</head>
<body>

<script type="text/javascript">
    let userId = window.prompt("输入用户名");
    let socket;
    if (typeof (WebSocket) == "undefined") {
        throw new Error('您的浏览器不支持WebSocket');
    } else {
        console.log("您的浏览器支持WebSocket");
    }
    console.log("用户 => " + userId)
    socket = new WebSocket(`ws://localhost:3000/ws/chart/${userId}`);

    /**
     * 打开事件
     */
    socket.onopen = function () {
        console.log("socket已打开...");
    };

    /**
     * 获得消息事件
     * @param msg 服务端返回的消息
     */
    socket.onmessage = function (msg) {
        console.log(JSON.parse(msg.data));
    };
    /**
     * 关闭事件
     */
    socket.onclose = function () {
        console.log("socket已关闭...");
    };
    /**
     * 发生了错误事件
     */
    socket.onerror = function () {
        console.warn("socket发生了错误...");
    }

    // let s1 = new WebSocket("ws://localhost:3000/ws/chart/666");
    // let s2 = new WebSocket("ws://localhost:3000/ws/chart/999");
    // s1.send("大家好");


</script>


</body>
</html>